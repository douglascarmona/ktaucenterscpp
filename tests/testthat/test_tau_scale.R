test_that("tau_scale works", {
    u1 <- c(
        -5.9957109, 3.7043719, 8.3375155, -4.3120109, -7.9069974,
        4.0211492, 0.5591997, 6.1587040, 9.1300025, -7.7909396
        )
    u2 <- c(
        -6.4290374, -9.7518368, -7.0511081, -3.4985002, -3.9629706,
        -2.4026255, -6.6018854, 2.3083618, 0.8768204, 0.5212299
        )
    s1 <- mscale(u = u1, c = 1.0, b = 0.5)
    s2 <- mscale(u = u2, c = 1.0, b = 0.5)
    expect_equal(round(tau_scale(u = u1, c = 1.0, s = s1, b = 0.1), 6), 7.703196)
    expect_equal(round(tau_scale(u = u2, c = 1.0, s = s2, b = 0.1), 6), 5.405463)
})

test_that("wni works", {
    u1 <- c(
        -5.9957109, 3.7043719, 8.3375155, -4.3120109, -7.9069974,
        4.0211492, 0.5591997, 6.1587040, 9.1300025, -7.7909396
        )
    u2 <- c(
        -6.4290374, -9.7518368, -7.0511081, -3.4985002, -3.9629706,
        -2.4026255, -6.6018854, 2.3083618, 0.8768204, 0.5212299
        )
    s1 <- mscale(u = u1, c = 1.0, b = 0.5)
    s2 <- mscale(u = u2, c = 1.0, b = 0.5)
    expect_equal(round(wni(u = u1, c1 = 1.0, c2 = 1.0, s = s1, b1 = 0.5, b2 = 0.1), 6), c(0.307692, 0.307692, 0.211861, 0.307692, 0.258359, 0.307692, 0.307692, 0.307692, 0.106206, 0.268642))
    expect_equal(round(wni(u = u2, c1 = 1.0, c2 = 1.0, s = s2, b1 = 0.5, b2 = 0.1), 6), c(0.101891, 0.000000, 0.008357, 0.307692, 0.307692, 0.307692, 0.069720, 0.307692, 0.307692, 0.307692))
})

